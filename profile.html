<!DOCTYPE html>
<html lang="af">
<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S9V4CMP1FP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S9V4CMP1FP');
  </script>

  <!-- AdSense verification -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8199352351586797"
          crossorigin="anonymous"></script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Profiel ‚Äì Kriptiek</title>

  <!-- Favicons -->
  <link rel="icon" href="/assets/favicon.ico?v=2" type="image/x-icon" />
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png?v=3">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png?v=3">
  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png?v=3">
  <link rel="manifest" href="/assets/site.webmanifest?v=3">

  <!-- Fonts & Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700;800;900&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Montserrat', sans-serif; background-color: #f3f4f6; }

    /* --- Header/logo styles --- */
    .logo-container { position: relative; display: flex; justify-content: center; align-items: center;
      width: fit-content; margin: 1rem auto; padding: 1rem; border-radius: 1rem; background-color: white; overflow: hidden; isolation: isolate; }
    .logo-container::before{ content:""; position:absolute; inset:-2px; border-radius:1rem;
      background:conic-gradient(from 180deg at 50% 50%, #1e3a8a, #334155, #1e3a8a);
      animation:spin 14s linear infinite; z-index:0; padding:2px;
      mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude; }
    @keyframes spin{ to{ transform:rotate(1turn); } }
    @media (prefers-reduced-motion: reduce){ .logo-container::before{ animation:none; } }

    .crossword-grid { display: grid; grid-template-columns: repeat(8, minmax(40px, 1fr)); gap: 4px; position: relative; z-index: 10; }
    .letter-box { width: 50px; height: 50px; display: flex; justify-content: center; align-items: center;
      background-color: #374151; color: white; font-size: 1.8rem; font-weight: bold; border: 2px solid #1f2937; border-radius: 0.375rem;
      text-transform: uppercase; box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2); }
    .flipped-k { transform: scaleX(-1); }

    .background-crossword { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: grid;
      grid-template-columns: repeat(auto-fill, minmax(30px, 1fr)); grid-template-rows: repeat(auto-fill, minmax(30px, 1fr));
      opacity: 0.5; z-index: 1; pointer-events: none; animation: bgFloat 30s linear infinite; }
    @keyframes bgFloat{ 0%{ transform:translateY(0); } 50%{ transform:translateY(-12px); } 100%{ transform:translateY(0); } }

    .bg-letter-box { display: flex; justify-content: center; align-items: center; font-size: 1.1rem;
      font-weight: bold; color: #9ca3af; border: 1px solid #e5e7eb; background-color: transparent; user-select: none; }

    /* --- Card + pill styling --- */
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:0.75rem; box-shadow:0 2px 6px rgba(2,6,23,.04); }
    .pill { display:inline-flex; align-items:center; border-radius:999px; padding:.35rem .9rem; font-weight:800; font-size:.9rem; }
    .pill-lg { padding:.45rem .95rem; font-size:1rem; }
    .pill-blue { background:#e0e7ff; color:#1e3a8a; }
    .pill-orange { background:#fff1e6; color:#c2410c; }
    .pill-green { background:#e8fff3; color:#065f46; }
    .pill-green-dark { background:#e6fffb; color:#115e59; }
    .mono { font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1, 'lnum' 1; }
    .mini { background:#f8fafc; border:1px solid #e5e7eb; border-radius:.75rem; padding:.5rem .6rem; text-align:center; }
    .medalje-pill { display:inline-flex; align-items:center; border:1px solid #cbd5e1; background:#f8fafc; color:#334155; border-radius:999px; padding:.2rem .55rem; font-size:.72rem; font-weight:700; line-height:1; }
  </style>

  <!-- === Feature toggles === -->
  <script>
    const FEATURES = { dilemma: true, blitstiek: true, slimstiek: false };
    function applyFeatureToggles() {
      const known = new Set(Object.keys(FEATURES));
      document.querySelectorAll('[data-section]').forEach(el => {
        const key = el.getAttribute('data-section');
        if (!known.has(key)) return;
        const on = !!FEATURES[key];
        el.style.display = on ? '' : 'none';
        el.setAttribute('aria-hidden', on ? 'false' : 'true');
      });
    }
    document.addEventListener('DOMContentLoaded', applyFeatureToggles);
  </script>

  <!-- Firebase setup -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, sendPasswordResetEmail, deleteUser, updateProfile } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
    import {
      getFirestore, doc, getDoc, setDoc, updateDoc,
      collection, query, orderBy, limit, getDocs, serverTimestamp,
      where
    } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDH-nVvGkdaheH7pvRHH0M9TbW2f98lMGQ",
      authDomain: "kriptiek-c9ea2.firebaseapp.com",
      projectId: "kriptiek-c9ea2",
      storageBucket: "kriptiek-c9ea2.appspot.com",
      messagingSenderId: "620450620939",
      appId: "1:620450620939:web:e93a18ac23b53b33db890e"
    };

    /* === Helpers === */
    function todayZaISO(){
      const now = new Date();
      const utc = now.getTime() + now.getTimezoneOffset()*60000;
      const za  = new Date(utc + 120*60000);
      return za.toISOString().slice(0,10);
    }
    const GAME_TODAY = `Game${todayZaISO()}`;

    const $ = (id) => document.getElementById(id);
    const fmt = (n) => (typeof n === "number" ? n.toLocaleString("af-ZA") : n);
    const toInt = (v) => (typeof v === "number" ? Math.trunc(v) : (v == null ? 0 : Math.trunc(Number(v) || 0)));

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    function setWbName(name){
      const el = $("wbName");
      if (el) el.textContent = (name || "Gebruiker").toUpperCase();
    }

    function getSupporterState(u){
      let active = false, untilTs = null;
      if (u?.supporterActive === true) active = true;
      if (u?.isPaid === true) active = true;
      if (u?.isSupporter === true) active = true;

      const until =
        (u?.supporterUntil?.toMillis && u.supporterUntil.toMillis()) ||
        (typeof u?.supporterUntil === 'number' ? u.supporterUntil :
          (u?.supporterUntil ? Date.parse(u.supporterUntil) : null)) ||
        (typeof u?.paidUntil === 'number' ? u.paidUntil :
          (u?.paidUntil ? Date.parse(u.paidUntil) : null));

      if (Number.isFinite(until) && until > Date.now()) { active = true; untilTs = until; }
      return { active, untilTs };
    }
        /* === BLITSTIEK (today + overall) === */

    function parseBlitTimeMs(row){
      if (!row) return NaN;
      if (typeof row.timeMs === "number") return row.timeMs;
      if (typeof row.time === "number")   return row.time * 1000;
      if (typeof row.time === "string") {
        const parts = row.time.split(":").map(Number);
        if (parts.length === 2) return (parts[0]*60 + parts[1]) * 1000;
        if (parts.length === 1) return parts[0] * 1000;
      }
      return NaN;
    }

    function blitInstantBonus(timeMs){
      if (!Number.isFinite(timeMs)) return 0;
      if (timeMs < 30000) return 200;
      if (timeMs < 60000) return 100;
      return 0;
    }

    async function loadBlitstiekToday(uid, userDoc){
      // direct doc id = uid
      let snap = await getDoc(doc(db, "blitstiekGames", GAME_TODAY, "leaderboard", uid));
      let row = snap.exists() ? { id: snap.id, ...snap.data() } : null;

      // fallback if any legacy wrote uid field in an auto-id doc
      if (!row) {
        try {
          const qs = await getDocs(query(
            collection(db, "blitstiekGames", GAME_TODAY, "leaderboard"),
            where("uid", "==", uid),
            limit(1)
          ));
          qs.forEach(d => { if (!row) row = { id: d.id, ...d.data() }; });
        } catch {}
      }

      const ms = parseBlitTimeMs(row);
      const instant = blitInstantBonus(ms);

      // Your cutoff function writes `total`, not `dailyPoints`
      let place = null;
      if (row && typeof row.total === "number") place = row.total;
      if (row && typeof row.dailyPoints === "number") place = row.dailyPoints;
      if (typeof userDoc?.blit_todayPoints === "number") place = userDoc.blit_todayPoints;

      return { instant, place };
    }

    async function loadBlitstiekOverall(userDoc){
      // Your existing function writes users/{uid}.blitstiekTotal
      const n =
        userDoc?.blitstiekTotalConfirmed ??
        userDoc?.blitstiekTotal ??
        userDoc?.kBlit_total ??
        userDoc?.kBlitTotal ??
        userDoc?.blit_total ??
        0;

      return (typeof n === "number") ? n : Number(n || 0);
    }

    /* === Medaljes (profile summary) === */

    // Count podium finishes from cutoff results: blitstiekGames/{gameId}/leaderboard/{uid}.placementPlace
    async function loadBlitstiekMedalsFromPlacements(uid){
      const out = { gold: 0, silver: 0, bronze: 0 };
      if (!uid) return out;

      try{
        let gamesSnap = null;

        // Prefer createdAt ordering if it exists, else fallback (no orderBy)
        try{
          gamesSnap = await getDocs(query(
            collection(db, "blitstiekGames"),
            orderBy("createdAt", "desc"),
            limit(400)
          ));
        }catch{
          gamesSnap = await getDocs(query(
            collection(db, "blitstiekGames"),
            limit(400)
          ));
        }

        const reads = [];
        gamesSnap.forEach(g => {
          reads.push(getDoc(doc(db, "blitstiekGames", g.id, "leaderboard", uid)));
        });

        const snaps = await Promise.all(reads);

        snaps.forEach(s => {
          if (!s.exists()) return;
          const p = Number(s.data()?.placementPlace);
          if (p === 1) out.gold++;
          else if (p === 2) out.silver++;
          else if (p === 3) out.bronze++;
        });

      }catch(e){
        console.warn("MEDALS_PLACE_QUERY_FAILED", e);
      }

      return out;
    }

    function inferBlitMedalsFromArray(arr){
      const out = { gold: 0, silver: 0, bronze: 0 };
      if (!Array.isArray(arr)) return out;

      for (const raw of arr){
        // Object-shaped medals
        if (raw && typeof raw === "object") {
          const place = Number(raw.place ?? raw.rank ?? raw.position ?? raw.pos ?? raw.podium ?? NaN);
          if (place === 1) out.gold++;
          else if (place === 2) out.silver++;
          else if (place === 3) out.bronze++;
          else {
            const medal = String(raw.medal ?? raw.type ?? raw.name ?? raw.label ?? "").toLowerCase();
            if (medal === "gold" || medal === "goud" || medal.includes("1")) out.gold++;
            else if (medal === "silver" || medal === "silwer" || medal.includes("2")) out.silver++;
            else if (medal === "bronze" || medal === "brons" || medal.includes("3")) out.bronze++;
          }
          continue;
        }

        // String-shaped medals
        const s = String(raw || "").toLowerCase();
        if (/\b1ste\b|\beerste\b|ü•á/.test(s)) out.gold++;
        else if (/\b2de\b|\btweede\b|ü•à/.test(s)) out.silver++;
        else if (/\b3de\b|\bderde\b|ü•â/.test(s)) out.bronze++;
        else if (/\bgoud\b|\bgold\b/.test(s)) out.gold++;
        else if (/\bsilwer\b|\bsilver\b/.test(s)) out.silver++;
        else if (/\bbrons\b|\bbronze\b/.test(s)) out.bronze++;
      }

      return out;
    }
        function renderBlitstiekMedalCounts(userDoc, derived){
      const line = $("medalsBlitLine");
      const breakdown = $("medalsBlitBreakdown");
      const empty = $("medalsBlitEmpty");

      // Accept multiple schema shapes (gold/silver/bronze OR first/second/third OR 1/2/3)
      const m =
        userDoc?.medals?.blitstiek ??
        userDoc?.blitstiekMedals ??
        userDoc?.blit_medals ??
        userDoc?.blitMedals ??
        null;

      let gold = toInt(m?.gold ?? m?.goud ?? m?.first ?? m?.firstPlace ?? m?.place1 ?? m?.["1"]);
      let silver = toInt(m?.silver ?? m?.silwer ?? m?.second ?? m?.secondPlace ?? m?.place2 ?? m?.["2"]);
      let bronze = toInt(m?.bronze ?? m?.brons ?? m?.third ?? m?.thirdPlace ?? m?.place3 ?? m?.["3"]);

      // Fallback: legacy arrays
      if ((gold + silver + bronze) === 0) {
        const legacy =
          userDoc?.blitstiekMedaljes ||
          userDoc?.medaljes ||
          userDoc?.publicMedaljes ||
          userDoc?.inlineMedaljes;

        const inf = inferBlitMedalsFromArray(legacy);
        if ((inf.gold + inf.silver + inf.bronze) > 0) {
          gold = inf.gold; silver = inf.silver; bronze = inf.bronze;
        }
      }

      // Fallback: cutoff results (placementPlace history)
      if ((gold + silver + bronze) === 0 && derived && typeof derived === "object") {
        const dg = toInt(derived.gold);
        const ds = toInt(derived.silver);
        const dbz = toInt(derived.bronze);
        if ((dg + ds + dbz) > 0) { gold = dg; silver = ds; bronze = dbz; }
      }

      const total = gold + silver + bronze;

      if (line) line.textContent = `Medaljes: ${fmt(total)}`;

      if (total > 0) {
        if (breakdown) {
          breakdown.textContent = `ü•á ${fmt(gold)}  ‚Ä¢  ü•à ${fmt(silver)}  ‚Ä¢  ü•â ${fmt(bronze)}`;
          breakdown.classList.remove("hidden");
        }
        if (empty) empty.classList.add("hidden");
      } else {
        if (breakdown) breakdown.classList.add("hidden");
        if (empty) empty.classList.remove("hidden");
      }
    }

    function renderSupporterStarIcon(isSupporter){
      return isSupporter === true
        ? '<span class="inline-block ml-1 align-middle text-yellow-400" aria-label="Ondersteuner">‚òÖ</span>'
        : "";
    }

    function renderProfileNameLine(name, supporterActive){
      const target = $("profileNameLine");
      if (!target) return;

      const safeName = String(name || "Gebruiker")
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;');

      target.innerHTML =
        `<span class="font-black text-slate-900">${safeName}</span>` +
        renderSupporterStarIcon(!!supporterActive);
    }

    function renderSupporterPill(state){
      const el=$("supporterPill"); if(!el) return;
      if(state.active){
        const extra = state.untilTs ? ` ‚Äî tot ${new Date(state.untilTs).toLocaleDateString("af-ZA")}` : "";
        el.textContent = "ONDERSTEUNER: AKTIEF"+extra;
        el.style.background="#dcfce7"; el.style.color="#065f46"; el.style.border="1px solid #bbf7d0";
        el.classList.add("font-extrabold");
      }else{
        el.textContent="ONDERSTEUNER: NIE AKTIEF NIE";
        el.style.background="#fef2f2"; el.style.color="#991b1b"; el.style.border="1px solid #fecaca";
        el.classList.add("font-extrabold");
      }
    }

    function renderNumbers({ bltOverall, bltToday }){
      const overallPill = $("pillOverall");
      if (overallPill) overallPill.textContent = "JOU KRIPTIEK-TELLING: BINNEKORT";

      const dilPill = $("pillDilemmaLive");
      if (dilPill) dilPill.textContent = "JOU DILEMMA-TELLING: BINNEKORT";

      if ($("pillBlitLive")) $("pillBlitLive").textContent = `JOU BLITSTIEK-TELLING: ${fmt(bltOverall ?? 0)}`;

      if ($("blitOverallScore")) $("blitOverallScore").textContent = fmt(bltOverall ?? 0);
      if ($("calcTimeBlit")) $("calcTimeBlit").textContent = new Date().toLocaleString("af-ZA");
      if ($("totalPointsBlit")) $("totalPointsBlit").textContent = (bltToday==null ? "‚Äî" : fmt(bltToday));
    }

    async function hydrateProfile(user){
      const nameEl  = $("nameInput");
      const emailEl = $("emailInput");
      if(nameEl)  nameEl.value  = user.displayName || "";
      if(emailEl) emailEl.value = user.email || "";

      // Ensure users doc exists
      const uref = doc(db, "users", user.uid);
      let userDocSnap = await getDoc(uref);
      if (!userDocSnap.exists()) {
        await setDoc(
          uref,
          { userName: user.displayName || "Gebruiker", createdAt: serverTimestamp(), updatedAt: serverTimestamp() },
          { merge: true }
        );
        userDocSnap = await getDoc(uref);
      }
      const userDoc = userDocSnap.data() || {};

      const supporter = getSupporterState(userDoc);
      renderSupporterPill(supporter);

      const displayName = user.displayName || userDoc.userName || "Gebruiker";
      setWbName(displayName);
      renderProfileNameLine(displayName, supporter.active);

      // Derive medals from placementPlace when no aggregates/legacy exist
      let derived = null;

      const m =
        userDoc?.medals?.blitstiek ??
        userDoc?.blitstiekMedals ??
        userDoc?.blit_medals ??
        userDoc?.blitMedals ??
        null;

      const aggTotal =
        toInt(m?.gold ?? m?.goud ?? m?.first ?? m?.firstPlace ?? m?.place1 ?? m?.["1"]) +
        toInt(m?.silver ?? m?.silwer ?? m?.second ?? m?.secondPlace ?? m?.place2 ?? m?.["2"]) +
        toInt(m?.bronze ?? m?.brons ?? m?.third ?? m?.thirdPlace ?? m?.place3 ?? m?.["3"]);

      if (aggTotal === 0) {
        derived = await loadBlitstiekMedalsFromPlacements(user.uid);
      }

      renderBlitstiekMedalCounts(userDoc, derived);

      // Supporter banner
      const supporterBanner = document.getElementById("supporterBanner");
      if (supporterBanner) {
        if (supporter.active) {
          supporterBanner.className = "block text-center font-bold rounded-lg p-3 mb-4 bg-green-50 border border-green-200 text-green-800";
          supporterBanner.textContent = "Jy is 'n betalende ondersteuner ‚Äî dankie!";
        } else {
          supporterBanner.className = "block text-center font-bold rounded-lg p-3 mb-4 bg-red-50 border border-red-200 text-red-800";
          supporterBanner.textContent = "Kliek hier om 'n betalende ondersteuner te word";
        }
      }

      // Blitstiek (overall + today)
      const bltOverall = await loadBlitstiekOverall(userDoc);
      const { instant: bltInstant, place: bltPlace } = await loadBlitstiekToday(user.uid, userDoc);

      let bltTodayTotal = null;
      if (bltPlace != null) bltTodayTotal = Number(bltInstant) + Number(bltPlace);
      else if (bltInstant)  bltTodayTotal = Number(bltInstant);

      const blitOverallUpdated = document.getElementById("blitOverallUpdated");
      if (blitOverallUpdated) blitOverallUpdated.textContent = new Date().toLocaleString("af-ZA");

      renderNumbers({ bltOverall, bltToday: bltTodayTotal });

      if (typeof gtag === 'function') gtag('event','profile_view',{ uid: user.uid });
    }
        function wireProfileForm(user){
      const form = $("profileForm");
      const resetBtn = $("resetPwBtn");
      const delBtn = $("deleteBtn");

      if(form){
        form.addEventListener("submit", async (e)=>{
          e.preventDefault();
          try{
            const newName = ($("nameInput").value||"").trim().slice(0,40);
            if(newName && newName !== (user.displayName||"")){
              await updateProfile(user, { displayName: newName });
              await updateDoc(doc(db,"users",user.uid), { userName: newName, updatedAt: serverTimestamp() });
              alert("Profiel gestoor.");
            } else {
              alert("Geen veranderinge om te stoor nie.");
            }
          }catch(err){ console.error(err); alert("Kon nie jou profiel opdateer nie."); }
        });
      }

      if(resetBtn){
        resetBtn.addEventListener("click", async ()=>{
          try{
            await sendPasswordResetEmail(auth, auth.currentUser.email);
            alert("‚Äôn Wagwoordherstel-skakel is per e-pos gestuur.");
          }catch(err){ console.error(err); alert("Kon nie wagwoordherstel stuur nie."); }
        });
      }

      if(delBtn){
        delBtn.addEventListener("click", async ()=>{
          if(!confirm("Is jy seker? Jou rekening sal verwyder word.")) return;
          try{
            await deleteUser(auth.currentUser);
            alert("Rekening verwyder.");
            window.location.href = "/";
          }catch(err){
            console.error(err);
            alert(String(err.code||"").includes("requires-recent-login")
              ? "Meld asseblief weer aan en probeer dan weer."
              : "Kon nie jou rekening verwyder nie.");
          }
        });
      }
    }

    // ---- Auth gate + bootstrap ----
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        const ret = encodeURIComponent("/profile.html");
        window.location.href = `/login.html?return=${ret}`;
        return;
      }
      try{
        await hydrateProfile(user);
        wireProfileForm(user);
      }catch(e){
        console.error(e);
      }
    });
  </script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-white shadow p-4">
    <div class="logo-container">
      <div id="backgroundCrossword" class="background-crossword"></div>
      <div class="crossword-grid">
        <div class="letter-box flipped-k">K</div>
        <div class="letter-box flipped-k">R</div>
        <div class="letter-box">I</div>
        <div class="letter-box flipped-k">P</div>
        <div class="letter-box">T</div>
        <div class="letter-box">I</div>
        <div class="letter-box flipped-k">E</div>
        <div class="letter-box">K</div>
      </div>
    </div>
  </header>

  <div class="max-w-6xl mx-auto px-4 pt-2 text-center text-2xl font-bold text-[#1e3a8a]">
    WELKOM TERUG, <span id="wbName">GEBRUIKER</span>
  </div>

  <main class="flex-grow p-4 pb-16">
    <div class="max-w-6xl mx-auto flex flex-col gap-6 items-stretch">

      <!-- PROFILE CARD -->
      <section class="card p-5 md:p-6">
        <a id="supporterBanner" href="https://buymeacoffee.com/kriptiek" target="_blank" rel="noopener"
           class="block text-center font-bold rounded-lg p-3 mb-4 bg-red-50 border border-red-200 text-red-800">
          Kliek hier om 'n betalende ondersteuner te word
        </a>

        <h2 class="text-lg font-bold mb-1">Profiel</h2>
        <div id="profileNameLine" class="flex flex-wrap items-center gap-1 mb-3 text-base"></div>

        <form id="profileForm" class="space-y-4" novalidate>
          <div>
            <label for="nameInput" class="block text-sm font-semibold text-gray-700">Naam (kan ‚Äôn skuilnaam wees)</label>
            <input id="nameInput" type="text" minlength="2" maxlength="40" required class="mt-1 w-full border border-gray-300 rounded p-2" value="Speler"/>
          </div>
          <div>
            <label for="emailInput" class="block text-sm font-semibold text-gray-700">E-posadres</label>
            <input id="emailInput" type="email" required class="mt-1 w-full border border-gray-300 rounded p-2" value="speler@example.com" disabled/>
            <p class="text-xs text-slate-500 mt-1">Jou e-pos kan nie hier verander word nie.</p>
          </div>

          <div class="flex flex-wrap items-center gap-2">
            <button type="submit" class="px-4 py-2 rounded-xl bg-blue-900 text-white font-bold">B√äRE</button>
            <button id="resetPwBtn" type="button" class="px-4 py-2 rounded-xl bg-slate-800 text-white font-bold">VRA NUWE WAGWOORD</button>
            <button id="deleteBtn" type="button" class="px-4 py-2 rounded-xl bg-red-700 text-white font-bold">VERWYDER MY REKENING</button>
          </div>
        </form>
      </section>
      <!-- MEDALJES -->
      <section class="card p-5 md:p-6">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-yellow-400 rounded-full"></div>
          <h2 class="text-xl font-extrabold text-slate-900">MEDALJES</h2>
        </header>

        <p class="text-sm text-slate-700 mb-3">
          ‚Äôn Ondersteuner-ster (‚òÖ) wys langs jou naam as jy ‚Äôn betalende Ondersteuner is.
          Medaljes hieronder wys jou podium-prestasies per speletjie.
        </p>

        <a href="https://buymeacoffee.com/kriptiek" target="_blank" rel="noopener"
           class="inline-flex items-center px-4 py-2 rounded-xl bg-yellow-500 hover:bg-yellow-600 text-white font-bold mb-4">
          Word ‚Äôn Ondersteuner
        </a>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
          <div class="mini">
            <div class="text-xs uppercase tracking-wide text-slate-500 font-extrabold">Dilemma</div>
            <div class="mt-1 text-lg font-extrabold text-slate-900">Medaljes: BINNEKORT</div>
            <div class="text-sm text-slate-500 mt-1">Kom binnekort</div>
          </div>

          <div class="mini">
            <div class="text-xs uppercase tracking-wide text-slate-500 font-extrabold">Blitstiek</div>
            <div id="medalsBlitLine" class="mt-1 text-lg font-extrabold text-slate-900">Medaljes: 0</div>
            <div id="medalsBlitBreakdown" class="hidden text-sm font-bold text-slate-700 mt-1">ü•á 0  ‚Ä¢  ü•à 0  ‚Ä¢  ü•â 0</div>
            <div id="medalsBlitEmpty" class="text-sm text-slate-500 mt-1">Nog geen medaljes in Blitstiek nie</div>
          </div>

          <div class="mini">
            <div class="text-xs uppercase tracking-wide text-slate-500 font-extrabold">Slimstiek</div>
            <div class="mt-1 text-lg font-extrabold text-slate-900">Medaljes: BINNEKORT</div>
            <div class="text-sm text-slate-500 mt-1">Kom binnekort</div>
          </div>
        </div>
      </section>

      <!-- OVERVIEW -->
      <section class="card p-5 md:p-6">
        <div class="mb-2">
          <span id="supporterPill" class="pill pill-lg" style="background:#f1f5f9;color:#0f172a;border:1px solid #e2e8f0">
            ONDERSTEUNER: NIE AKTIEF NIE
          </span>
        </div>

        <div class="mb-4">
          <span id="pillOverall" class="pill pill-lg pill-blue">JOU KRIPTIEK-TELLING: BINNEKORT</span>
        </div>

        <div class="flex flex-wrap gap-2 mb-4 items-start">
          <span id="pillDilemmaLive" class="pill pill-lg pill-orange">JOU DILEMMA-TELLING: BINNEKORT</span>
          <span id="pillBlitLive" class="pill pill-lg pill-green">JOU BLITSTIEK-TELLING: 0</span>
          <span class="pill pill-lg pill-green-dark">JOU SLIMSTIEK-TELLING: BINNEKORT</span>
        </div>

        <p class="text-sm text-slate-600">
          Die ou ‚Äútelling‚Äù-stelsel word vervang. Jou medalje-opsomming per speletjie is bo.
        </p>
      </section>

      <!-- DILEMMA -->
      <section class="card p-5 md:p-6" data-section="dilemma">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-orange-500 rounded-full"></div>
          <h2 class="text-xl font-extrabold text-slate-900">DILEMMA</h2>
        </header>

        <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
          <div class="text-sm font-semibold text-slate-800">Medaljes vir Dilemma kom binnekort.</div>
          <div class="text-xs text-slate-500 mt-1">
            Hier gaan jou podium-prestasies wys sodra die nuwe medalje-stelsel vir Dilemma klaar is.
          </div>
        </div>
      </section>

      <!-- BLITSTIEK -->
      <section class="card p-5 md:p-6" data-section="blitstiek">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-emerald-500 rounded-full"></div>
          <h2 class="text-xl font-extrabold text-slate-900">BLITSTIEK</h2>
        </header>

        <div class="rounded-xl border border-slate-200 bg-white p-4 mb-3">
          <div class="flex items-end justify-between">
            <div>
              <div id="blitOverallScore" class="text-6xl font-black mono text-slate-900 tracking-tight">0</div>
              <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
            </div>
            <div class="text-right">
              <div class="text-xs text-slate-500">Laas opgedateer</div>
              <div id="blitOverallUpdated" class="text-sm mono">‚Äî</div>
            </div>
          </div>
        </div>

        <div class="rounded-xl border border-emerald-200 bg-emerald-50 p-4 mb-3">
          <div class="flex items-end justify-between">
            <div>
              <div id="totalPointsBlit" class="text-4xl font-extrabold mono text-emerald-900">‚Äî</div>
              <div class="text-xs uppercase tracking-wide text-emerald-900/70">Vandag</div>
            </div>
            <div class="text-right">
              <div class="text-xs text-emerald-900/70">Laas bereken</div>
              <div id="calcTimeBlit" class="text-sm mono">‚Äî</div>
            </div>
          </div>
        </div>

        <div class="rounded-xl bg-gray-50 p-4 border border-gray-200 mt-3">
          <h3 class="font-semibold text-gray-800 mb-2">Blitstiek: Telling & ranglys</h3>

          <ul class="list-disc list-inside text-gray-700 space-y-1">
            <li>Die ranglys wys <strong>die dag se 10 beste tye.</strong></li>
            <li>Jou naam verskyn hoogstens een keer op die dag se lys, en ‚Äôn beter tyd vervang jou vorige swakker tyd.</li>
          </ul>

          <ul class="list-disc list-inside text-gray-700 space-y-1 ml-5">
            <li><strong>200 punte</strong> vir ‚Äôn voltooiing in <strong>onder 30 sekondes</strong></li>
            <li><strong>100 punte</strong> vir ‚Äôn voltooiing in <strong>onder 60 sekondes</strong></li>
          </ul>

          <ul class="list-disc list-inside text-gray-700 space-y-1 mt-2">
            <li>Jy kry <strong>bonuspunte vir jou posisie op die ranglys om 23:55</strong>:</li>
          </ul>

          <ul class="list-disc list-inside text-gray-700 space-y-1 ml-5">
            <li><strong>1ste plek</strong> ‚Äì 200 punte</li>
            <li><strong>2de plek</strong> ‚Äì 175 punte</li>
            <li><strong>3de plek</strong> ‚Äì 150 punte</li>
            <li><strong>4de plek</strong> ‚Äì 125 punte</li>
            <li><strong>5de plek</strong> ‚Äì 100 punte</li>
            <li><strong>6de plek</strong> ‚Äì 75 punte</li>
            <li><strong>7de plek</strong> ‚Äì 50 punte</li>
            <li><strong>8ste plek</strong> ‚Äì 40 punte</li>
            <li><strong>9de plek</strong> ‚Äì 30 punte</li>
            <li><strong>10de plek</strong> ‚Äì 20 punte</li>
          </ul>

          <ul class="list-disc list-inside text-gray-700 space-y-1 mt-2">
            <li>Betalende Kriptiek-ondersteuners kry ‚Äôn <strong>10%-bonus</strong> op die dag se ranglyspunte.</li>
            <li>Jou <strong>algehele Blitstiek-telling</strong> is die som van al jou vorige dae se bevestigde tellings,
                met ondersteunerbonusse bygereken.</li>
          </ul>
        </div>
      </section>
      <!-- SLIMSTIEK (hidden for now) -->
      <section class="card p-5 md:p-6" data-section="slimstiek" aria-hidden="true" style="display:none">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-teal-500 rounded-full"></div>
          <h2 class="text-xl font-extrabold text-slate-900">SLIMSTIEK</h2>
        </header>

        <div class="rounded-xl border border-slate-200 bg-white p-4 mb-3">
          <div class="flex items-end justify-between">
            <div>
              <div id="slimOverallScore" class="text-6xl font-black mono text-slate-900 tracking-tight">0</div>
              <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
            </div>
            <div class="text-right">
              <div class="text-xs text-slate-500">Laas opgedateer</div>
              <div id="slimOverallUpdated" class="text-sm mono">‚Äî</div>
            </div>
          </div>
        </div>

        <div class="rounded-xl border border-teal-200 bg-teal-50 p-4 mb-4">
          <div class="flex items-end justify-between">
            <div>
              <div id="totalPointsSlim" class="text-4xl font-extrabold mono text-teal-900">‚Äî</div>
              <div class="text-xs uppercase tracking-wide text-teal-900/70">Vandag</div>
            </div>
            <div class="text-right">
              <div class="text-xs text-teal-900/70">Laas bereken</div>
              <div id="calcTimeSlim" class="text-sm mono">‚Äî</div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <footer class="bg-white shadow p-4 text-center text-sm text-gray-500">
    &copy; 2025 Kriptiek. Alle regte voorbehou. |
    <a href="/index.html" class="underline">Tuis</a> |
    <a href="/forum.html" class="underline">Gesels saam</a> |
    <a href="/privacy.html" class="underline">Privaatheidsbeleid</a> |
    <a href="/terms.html" class="underline">Voorwaardes</a> |
    <a href="/faq.html" class="underline">Gereelde vrae</a> |
    <a href="/about.html" class="underline">Oor Kriptiek</a> |
    <a href="/contact.html" class="underline">Kontak ons</a>
  </footer>

  <!-- Background crossword init -->
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const bg = document.getElementById('backgroundCrossword'); if(!bg)return;
      const letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const rand=()=>letters[Math.floor(Math.random()*letters.length)];
      function regen(){
        bg.innerHTML='';
        const rows=Math.ceil(bg.offsetHeight/30);
        const cols=Math.ceil(bg.offsetWidth/30);
        const total=(rows*cols)||300;
        for(let i=0;i<total;i++){
          const d=document.createElement('div');
          d.className='bg-letter-box';
          d.textContent=rand();
          bg.appendChild(d);
        }
      }
      regen();window.addEventListener('resize',regen);
    });
  </script>

</body>
</html>

      
