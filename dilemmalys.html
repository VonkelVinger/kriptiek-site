<!DOCTYPE html>
<html lang="af">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S9V4CMP1FP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S9V4CMP1FP');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <title>DILEMMA-RANGLYS â€“ Kriptiek</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { color-scheme: light; }
    body{ font-family: 'Montserrat', sans-serif; background:#f3f4f6; color:#1f2937; }
    .pill{ background:#f97316; color:#fff; padding:.25rem .6rem; border-radius:9999px; font-weight:600; font-size:.875rem; }
    .leader-card{ max-width:640px; margin:1rem auto 0; background:#fff; border-radius:1rem; box-shadow:0 10px 20px rgba(0,0,0,.06); overflow:hidden; }
    .row{ display:flex; align-items:center; justify-content:space-between; padding:.75rem 1rem; border-bottom:1px solid #e5e7eb; }
    .row:nth-child(odd){ background:#ffffff; }
    .row:nth-child(even){ background:#f9fafb; }
    .rank{ width:2rem; text-align:right; font-weight:600; color:#6b7280; }
    .name{ font-weight:600; color:#111827; }
  </style>
</head>

<body class="min-h-screen flex flex-col">

  <!-- KRIPTIEK header (navy bar, flipped K) -->
  <header class="bg-[#1f2937] text-white">
    <div class="max-w-6xl mx-auto px-4 py-4">
      <a href="/index.html" class="block w-fit mx-auto select-none">
        <div class="flex items-center justify-center space-x-1 text-2xl font-bold tracking-widest">
          <span class="transform -scale-x-100">K</span><span>R</span><span>I</span><span>P</span><span>T</span><span>I</span><span>E</span><span>K</span>
        </div>
      </a>
    </div>
  </header>

  <main class="flex-1 px-4">
    <div class="max-w-6xl mx-auto">
      <h1 class="text-center text-2xl md:text-3xl font-bold text-[#1e3a8a] mt-8">DILEMMA-RANGLYS</h1>

      <!-- Leaderboard -->
      <section class="leader-card" id="card">
        <div id="leaderboard" role="list">
          <!-- rows injected here -->
        </div>
      </section>

      <div class="flex justify-center">
        <button id="toggleBtn"
          class="mt-4 mb-10 bg-[#1e40af] text-white px-4 py-2 rounded-lg hover:bg-[#1e3a8a] transition">
          Wys meer
        </button>
      </div>
    </div>
    <!-- Firebase (compat to match your other pages) -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

    <script>
      // Use your existing config (same as index/dilemmagame)
      (function initFirebase(){
        try{
          if(!firebase.apps.length){
            firebase.initializeApp({
              apiKey: "YOUR_API_KEY",
              authDomain: "YOUR_AUTH_DOMAIN",
              projectId: "YOUR_PROJECT_ID",
              storageBucket: "YOUR_STORAGE_BUCKET",
              messagingSenderId: "YOUR_SENDER_ID",
              appId: "YOUR_APP_ID"
            });
          }
        }catch(e){ console.warn("Firebase init warning:", e); }
      })();

      (function main(){
        const db = firebase.firestore();
        const listEl = document.getElementById('leaderboard');
        const toggleBtn = document.getElementById('toggleBtn');

        let allRows = [];     // up to 25
        let show25 = false;   // default show 10

        function row(rank, name, pts){
          const div = document.createElement('div');
          div.className = 'row';
          const left = document.createElement('div');
          left.className = 'flex items-center space-x-3';
          const r = document.createElement('div');
          r.className = 'rank';
          r.textContent = rank + '.';
          const n = document.createElement('div');
          n.className = 'name';
          n.textContent = name || 'Speler';
          left.appendChild(r); left.appendChild(n);

          const pill = document.createElement('div');
          pill.className = 'pill';
          pill.textContent = pts != null ? String(pts) : '0';

          div.appendChild(left); div.appendChild(pill);
          return div;
        }

        function render(){
          listEl.innerHTML = '';
          const count = Math.min(show25 ? 25 : 10, allRows.length);
          if(count === 0){
            const empty = document.createElement('div');
            empty.className = 'p-6 text-center text-gray-500';
            empty.textContent = 'Nog geen inskrywings.';
            listEl.appendChild(empty);
            toggleBtn.style.display = 'none';
            return;
          }
          for(let i=0;i<count;i++){
            const u = allRows[i];
            listEl.appendChild(row(i+1, u.userName, u.dilemmaPoints));
          }
          toggleBtn.style.display = allRows.length > 10 ? 'inline-flex' : 'none';
          toggleBtn.textContent = show25 ? 'Wys minder' : 'Wys meer';
        }

        async function load(){
          try{
            const snap = await db.collection('users')
              .orderBy('dilemmaPoints','desc')
              .limit(25)
              .get();

            allRows = snap.docs.map(d=>{
              const x = d.data()||{};
              return {
                userName: x.userName || 'Speler',
                dilemmaPoints: Number(x.dilemmaPoints || 0)
              };
            }).filter(u => u.dilemmaPoints > 0);

            render();
          }catch(err){
            console.error('Dilemma-ranglys load error:', err);
            listEl.innerHTML = '<div class="p-6 text-center text-red-600">Kon nie die ranglys laai nie.</div>';
            toggleBtn.style.display = 'none';
          }
        }

        toggleBtn.addEventListener('click', ()=>{
          show25 = !show25;
          render();
        });

        load();
      })();
    </script>
  </main>

  <!-- Full footer -->
  <footer class="bg-gray-100 text-gray-600 text-sm mt-auto">
    <div class="max-w-6xl mx-auto px-4 py-8 grid gap-4 md:grid-cols-2">
      <div>&copy; <span id="year"></span> Kriptiek</div>
      <nav class="flex flex-wrap gap-x-5 gap-y-2 justify-start md:justify-end">
        <a href="/index.html" class="hover:text-gray-800">Tuis</a>
        <a href="/dilemmagame.html" class="hover:text-gray-800">Dilemma</a>
        <a href="/blitstiek.html" class="hover:text-gray-800">Blitstiek</a>
        <a href="/slimstiek.html" class="hover:text-gray-800">Slimstiek</a>
        <a href="/gesels.html" class="hover:text-gray-800">Gesels saam</a>
        <a href="/blitstiek-argief.html" class="hover:text-gray-800">Argief</a>
        <a href="/privaatheid.html" class="hover:text-gray-800">Privaatheid</a>
      </nav>
    </div>
    <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
  </footer>

</body>
</html>
