<!DOCTYPE html>
<html lang="af">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S9V4CMP1FP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-S9V4CMP1FP');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Profiel – Kriptiek (toets)</title>

  <!-- Fonts & Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Base styles you already use (minimal helpers kept here to avoid drift) -->
  <style>
    :root { --k-blue:#1e3a8a; }
    body { font-family: 'Montserrat', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol'; }
    .mono { font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1, 'lnum' 1; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius: 0.75rem; box-shadow: 0 2px 6px rgba(2,6,23,.04); }
    .pill { display:inline-flex; align-items:center; border-radius:999px; padding:.25rem .6rem; font-weight:800; font-size:.82rem; }
    .pill-lg { padding:.4rem .75rem; font-size:.9rem; }
    .pill-blue { background:#e0e7ff; color:#1e3a8a; }
    .pill-orange { background:#fff1e6; color:#c2410c; }
    .pill-green { background:#e8fff3; color:#065f46; }
    .pill-green-dark { background:#e6fffb; color:#115e59; }
    .kbtn { background:var(--k-blue); color:#fff; font-weight:800; padding:.6rem .9rem; border-radius:.65rem; transition:all .15s; }
    .kbtn:hover { filter:brightness(.95); transform:translateY(-1px); }
    .kbtn-red { background:#b91c1c; }
    .banner { font-size:.75rem; font-weight:800; border-radius:.5rem; padding:.25rem .5rem; }
    .banner-live { background:#eefdf3; color:#065f46; border:1px solid #bbf7d0; }
    .table-wrap { border:1px solid #e5e7eb; border-radius:.75rem; overflow:hidden; }
    .table-scroll { overflow:auto; }
    table.table { border-collapse:collapse; }
    table.table th, table.table td { padding:.6rem .75rem; border-bottom:1px solid #eef2f7; }
    table.table thead th { font-size:.8rem; text-transform:uppercase; letter-spacing:.02em; color:#64748b; background:#fafbff; }
    .mini { background:#f8fafc; border:1px solid #e5e7eb; border-radius:.75rem; padding:.5rem .6rem; text-align:center; }
    .supporter-banner { display:block; text-align:center; font-weight:800; border-radius:.75rem; padding:.5rem .75rem; }
    .supporter-banner-red { background:#fff1f2; color:#991b1b; border:1px solid #fecdd3; }
    /* subtle skeleton class you can toggle while loading */
    .skeleton { position:relative; overflow:hidden; background:#eef2ff; }
    .skeleton::after { content:""; position:absolute; inset:0; transform:translateX(-100%); background:linear-gradient(90deg, transparent, rgba(255,255,255,.6), transparent); animation: shimmer 1.2s infinite; }
    @keyframes shimmer { 100% { transform:translateX(100%);} }
  </style>
</head>

<body class="bg-slate-50 text-slate-900">

  <!-- Header (kept minimal; keep your real site header if you have it) -->
  <header class="bg-white border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="/" class="text-xl font-extrabold text-slate-900">KRIPTIEK</a>
      <nav class="text-sm">
        <a href="/index.html" class="text-blue-700 hover:underline">Tuis</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-grow p-4 pb-16">

    <!-- Top block: MOBILE-FIRST stack of Profile + Kriptiek-telling -->
    <div class="max-w-6xl mx-auto flex flex-col gap-6 items-stretch">
      <!-- LEFT (Profile card) -->
      <section class="card p-5 md:p-6 top-card">
        <a id="supporterBanner" href="https://buymeacoffee.com/kriptiek" target="_blank" rel="noopener"
           class="supporter-banner supporter-banner-red mb-4"
           aria-label="Word ’n ondersteuner (Buy Me a Coffee)">
          <span id="supporterBannerTxt">Kliek hier om 'n betalende ondersteuner te word</span>
        </a>

        <h2 class="text-lg font-bold mb-2">Profiel</h2>
        <p id="errBanner" class="hidden text-sm mb-3 px-3 py-2 rounded bg-red-50 text-red-800" role="alert"></p>

        <form id="profileForm" class="space-y-4" novalidate>
          <div>
            <label for="nameInput" class="block text-sm font-semibold text-gray-700">Naam (kan ’n skuilnaam wees)</label>
            <input id="nameInput" type="text" minlength="2" maxlength="40" required class="mt-1 w-full border border-gray-300 rounded p-2" value="Speler"/>
          </div>
          <div>
            <label for="emailInput" class="block text-sm font-semibold text-gray-700">E-posadres</label>
            <input id="emailInput" type="email" required aria-describedby="emailHelp" class="mt-1 w-full border border-gray-300 rounded p-2" value="speler@example.com"/>
            <p id="emailHelp" class="text-xs text-gray-500 mt-1"><strong>Let wel:</strong> Jou e-pos word nie geverifieer nie, maar jy het dit nodig vir wagwoordherstel of navrae oor jou rekening.</p>
          </div>

          <div class="flex flex-wrap items-center gap-2">
            <button type="submit" class="kbtn" id="saveBtn">BÊRE</button>
            <button id="resetPwBtn" type="button" class="kbtn bg-slate-800 hover:bg-slate-900">VRA NUWE WAGWOORD</button>
            <button id="deleteBtn" type="button" class="kbtn kbtn-red">VERWYDER MY REKENING</button>
          </div>
          <p id="formMsg" class="text-sm mt-2 hidden" aria-live="polite" role="status"></p>
          <p id="deleteMsg" class="text-sm mt-2 hidden" aria-live="polite" role="status"></p>
        </form>
      </section>

      <!-- RIGHT (Kriptiek-telling overview) -->
      <section class="card p-5 md:p-6 top-card">
        <div class="mb-4"><span id="pillOverall" class="pill pill-lg pill-blue" role="status">JOU KRIPTIEK-TELLING: 0</span></div>
        <div class="flex flex-wrap gap-2 mb-6 items-start">
          <span id="pillDilemmaLive" class="pill pill-lg pill-orange" role="status">JOU DILEMMA-TELLING: 0</span>
          <span id="pillBlitLive" class="pill pill-lg pill-green" role="status">JOU BLITSTIEK-TELLING: 0</span>
          <span class="pill pill-lg pill-green-dark">JOU SLIMSTIEK-TELLING: BINNEKORT</span>
        </div>
        <h3 class="text-2xl md:text-[1.7rem] font-extrabold text-slate-900 mb-1">Hoe werk die Kriptiek-telling?</h3>
        <p class="text-sm text-slate-600">
          Jou Kriptiek-telling is die som van jou <strong>Dilemma</strong>- en <strong>Blitstiek</strong>-tellings (Slimstiek volg later).
        </p>
      </section>
    </div>

    <!-- GAMES -->
    <div class="max-w-6xl mx-auto space-y-6 mt-6">
      <!-- DILEMMA -->
      <section id="dilemma" class="card p-5 md:p-6 game-card">
        <!-- Color bar + header -->
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-orange-500 rounded-full"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold text-slate-900">DILEMMA</h2>
            <span id="streakChip" class="hidden px-2.5 py-1 rounded-full font-bold text-indigo-900" style="background:#e0e7ff">+10% lopie</span>
          </div>
        </header>

        <!-- Today vs Overall -->
        <div class="flex flex-col gap-3 mb-4">
          <!-- TODAY (uses your existing calcTime/totalPoints etc.) -->
          <div class="rounded-xl border border-orange-200 bg-orange-50 p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="totalPoints" class="text-4xl md:text-5xl font-extrabold mono text-orange-900">0</div>
                <div class="text-xs uppercase tracking-wide text-orange-900/70">Vandag</div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-orange-900/70">Laas bereken</div>
                <div id="calcTime" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-orange-900/80 mt-2">
              Lopie- en ondersteuner-bonusse word hier ingereken soos van toepassing.
            </div>
          </div>

          <!-- OVERALL (new IDs for your cumulative) -->
          <div class="rounded-xl border border-slate-200 bg-white p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="dilOverallScore" class="text-3xl md:text-4xl font-extrabold mono text-slate-900">0</div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-slate-500">Laas opgedateer</div>
                <div id="dilOverallUpdated" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-slate-600 mt-2">
              Die algehele totaal word minder gereeld verfris; ons wys wanneer dit laas opgedateer is.
            </div>
          </div>
        </div>

        <!-- Two-column content (stacked) -->
        <div class="flex flex-col gap-5 items-stretch">
          <!-- Breakdown -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
            <div class="table-wrap">
              <div class="table-scroll">
                <table class="table text-sm w-full">
                  <thead>
                    <tr>
                      <th class="text-left">Komponent</th>
                      <th class="text-right">Aantal</th>
                      <th class="text-right mono">Formule</th>
                      <th class="text-right">Punte</th>
                    </tr>
                  </thead>
                  <tbody id="breakdownBody"></tbody>
                  <tfoot>
                    <tr><td class="font-bold">Subtotaal</td><td></td><td></td><td class="text-right font-extrabold mono" id="subtotalCell">0</td></tr>
                    <tr><td class="font-bold">Lopie-bonus</td><td></td><td class="text-right whitespace-nowrap" id="lopieMeta">—</td><td class="text-right font-extrabold mono" id="lopieBonusCell">0</td></tr>
                    <tr><td class="font-bold">Ondersteuner-bonus</td><td></td><td class="text-right whitespace-nowrap" id="supporterMeta">—</td><td class="text-right font-extrabold mono" id="supporterBonusCell">0</td></tr>
                    <tr><td class="font-extrabold text-slate-900">Totaal (vandag)</td><td></td><td></td><td class="text-right font-extrabold mono text-orange-900" id="totalCell">0</td></tr>
                  </tfoot>
                </table>
              </div>
            </div>

            <details class="mt-4">
              <summary class="font-bold text-slate-800 cursor-pointer">Reëls (opsomming)</summary>
              <ul class="text-sm text-slate-700 mt-2 list-disc pl-5 space-y-1">
                <li><strong>Raaie:</strong> Hoe minder, hoe meer punte.</li>
                <li><strong>Lopie ≥5:</strong> +10% op dag-subtotaal.</li>
                <li><strong>Ondersteuner:</strong> +10% op dag-totaal (indien jy wen).</li>
                <li><strong>Misluk in 6 raaie:</strong> −50.</li>
              </ul>
            </details>
          </div>

          <!-- Stats -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Jou Dilemma-statistiek</h3>
            <div class="grid grid-cols-4 gap-2 mb-3">
              <div class="mini"><div id="playedStat" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Dilemmas gespeel</div></div>
              <div class="mini"><div id="winrateStat" class="text-3xl font-extrabold mono">0%</div><div class="text-xs text-slate-500 mt-1">Sukseskoers</div></div>
              <div class="mini"><div id="curStreak" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Huidige lopie</div></div>
              <div class="mini"><div id="bestStreak" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Beste lopie</div></div>
            </div>

            <h4 class="text-sm font-bold text-slate-700 mb-2">Suksesverdeling</h4>
            <div id="distWrap" class="space-y-2"></div>

            <p class="text-sm text-slate-600 mt-3">
              <span class="font-semibold">Leidraad:</span> Tans bestaan jou Kriptiek-telling nog net uit jou Dilemma-telling, maar later sal jou Blitstiek- en Slimstiek-tellings ook ingereken word.
            </p>
          </div>
        </div>
      </section>
      <!-- BLITSTIEK (LIVE, Firestore-driven) -->
      <section id="blitstiek" class="card p-5 md:p-6 game-card">
        <!-- Color bar + header -->
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-emerald-500 rounded-full"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold text-slate-900">BLITSTIEK</h2>
            <div id="bannerBlit" class="banner banner-live">Vandag (voorlopig, finale posisie om 23:55)</div>
          </div>
        </header>

        <!-- Today vs Overall -->
        <div class="flex flex-col gap-3 mb-4">
          <!-- TODAY (re-uses your ids) -->
          <div class="rounded-xl border border-emerald-200 bg-emerald-50 p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="totalPointsBlit" class="text-4xl md:text-5xl font-extrabold mono text-emerald-900">0</div>
                <div class="text-xs uppercase tracking-wide text-emerald-900/70">
                  Vandag se totaal (ná 23:55 sluit ondersteuners-×1.10 in, indien aktief)
                </div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-emerald-900/70">Laas bereken</div>
                <div id="calcTimeBlit" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-emerald-900/80 mt-2">
              Onmiddellik: &lt;60s = +100 • &lt;30s = +200. Posisie-bonus word bygevoeg @ 23:55.
            </div>
          </div>

          <!-- OVERALL -->
          <div class="rounded-xl border border-slate-200 bg-white p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="blitOverallScore" class="text-3xl md:text-4xl font-extrabold mono text-slate-900">0</div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-slate-500">Laas opgedateer</div>
                <div id="blitOverallUpdated" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-slate-600 mt-2">
              Totale Blitstiek-telling (alle dae); ons wys wanneer dit laas verfris is.
            </div>
          </div>
        </div>

        <!-- Two-column content (stacked) -->
        <div class="flex flex-col gap-5 items-stretch">
          <!-- Breakdown -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
            <div class="table-wrap">
              <div class="table-scroll">
                <table class="table text-sm w-full">
                  <thead>
                    <tr><th class="text-left">Komponent</th><th class="text-right">Reël</th><th class="text-right">Punte</th></tr>
                  </thead>
                  <tbody id="breakdownBodyBlit">
                    <tr>
                      <td>Tyd-bonus (vandag)</td>
                      <td class="text-right mono">&lt;60s = +100 • &lt;30s = +200 (een van die twee)</td>
                      <td class="text-right mono" id="blitInstantCell">0</td>
                    </tr>
                    <tr class="liveOnly">
                      <td>Posisie-bonus (om 23:55)</td>
                      <td class="text-right mono">1–10: 200,175,150,125,100,75,50,40,30,20</td>
                      <td class="text-right mono" id="blitPlaceCell">0</td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr class="liveOnly">
                      <td class="font-extrabold text-slate-900">Totaal (vandag)</td>
                      <td class="text-right text-slate-500">ná ondersteuners-×1.10 indien aktief</td>
                      <td id="totalCellBlit" class="text-right font-extrabold mono text-emerald-900">0</td>
                    </tr>
                    <tr class="archiveOnly hidden">
                      <td class="font-extrabold text-slate-900">Totaal (argief)</td>
                      <td class="text-right text-slate-500">geen posisie/ondersteuner-bonus</td>
                      <td id="totalCellBlitArchive" class="text-right font-extrabold mono text-emerald-900">0</td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>

            <details class="mt-4">
              <summary class="font-bold text-slate-800 cursor-pointer">Reëls vir Blitstiek (opsomming)</summary>
              <ul class="text-sm text-slate-700 mt-2 list-disc pl-5 space-y-1">
                <li>Ranglys: top 10 van die dag; een inskrywing per speler (beste tyd vervang ouer tyd).</li>
                <li><strong>Onmiddellik</strong>: &lt;60s = +100 • &lt;30s = +200 (een van die twee).</li>
                <li><strong>Om 23:55</strong>: posisie-bonus vir 1–10 = 200,175,150,125,100,75,50,40,30,20.</li>
                <li>By gelyke tye wen die vroeër aangetekende tyd.</li>
                <li>Ondersteuners kry <strong>×1.10</strong> op die dag se som (na 23:55 toegepas).</li>
                <li><strong>Argief</strong>: geen posisie/ondersteuner-bonus; slegs die <strong>onmiddellike</strong> tyd-bonus.</li>
              </ul>
            </details>
          </div>

          <!-- Stats -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Blitstiek-statistiek</h3>
            <div class="grid grid-cols-4 gap-2 mb-4">
              <div class="mini"><div id="playedStatBlit" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Gespeel</div></div>
              <div class="mini"><div id="bestTimeBlit" class="text-3xl font-extrabold mono">—</div><div class="text-xs text-slate-500 mt-1">Beste tyd</div></div>
              <div class="mini"><div id="avgTimeBlit" class="text-3xl font-extrabold mono">—</div><div class="text-xs text-slate-500 mt-1">Gemiddeld</div></div>
              <div class="mini"><div id="winsBlit" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Oorwinnings</div></div>
            </div>

            <h4 class="text-sm font-bold text-slate-700 mb-2">Verspreiding (bv. tyd-klasse)</h4>
            <div id="distWrapBlit" class="space-y-2 text-slate-400">Kom binnekort.</div>

            <div class="col-summary push-end text-sm text-slate-600 mt-2">
              <span class="font-semibold">Leidraad:</span> Blitstiek-punte tel by jou Kriptiek-totaal.
            </div>
          </div>
        </div>
      </section>
      <!-- SLIMSTIEK (shadow; unchanged scoring, unified layout) -->
      <section id="slimstiek" class="card p-5 md:p-6 game-card">
        <!-- Color bar + header -->
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-teal-500 rounded-full"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold text-slate-900">SLIMSTIEK</h2>
            <div id="bannerSlim" class="banner banner-live">Vandag (voorlopig, finale posisie om 23:55)</div>
          </div>
        </header>

        <!-- Today vs Overall -->
        <div class="flex flex-col gap-3 mb-4">
          <!-- TODAY -->
          <div class="rounded-xl border border-teal-200 bg-teal-50 p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="totalPointsSlim" class="text-4xl md:text-5xl font-extrabold mono text-teal-900">0</div>
                <div class="text-xs uppercase tracking-wide text-teal-900/70">Vandag se voorlopige punte</div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-teal-900/70">Laas bereken</div>
                <div id="calcTimeSlim" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-teal-900/80 mt-2">
              Vroeë/verbetering/posisie reëls geld soos hieronder; ×1.10 vir ondersteuners.
            </div>
          </div>

          <!-- OVERALL (can stay “binnekort” until live) -->
          <div class="rounded-xl border border-slate-200 bg-white p-4">
            <div class="flex items-end gap-4">
              <div>
                <div id="slimOverallScore" class="text-3xl md:text-4xl font-extrabold mono text-slate-900">0</div>
                <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
              </div>
              <div class="ml-auto text-right">
                <div class="text-xs text-slate-500">Laas opgedateer</div>
                <div id="slimOverallUpdated" class="text-sm mono" aria-live="polite">—</div>
              </div>
            </div>
            <div class="text-[13px] text-slate-600 mt-2">
              Totale Slimstiek-telling (binnekort aktief).
            </div>
          </div>
        </div>

        <!-- Two-column content (stacked) -->
        <div class="flex flex-col gap-5 items-stretch">
          <!-- Breakdown -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
            <div class="table-wrap">
              <div class="table-scroll">
                <table class="table text-sm w-full">
                  <thead>
                    <tr><th class="text-left">Komponent</th><th class="text-right">Reël</th><th class="text-right">Punte</th></tr>
                  </thead>
                  <tbody id="breakdownBodySlim">
                    <tr><td>Vroeë bonus vir eerste 10 tellings ná 07:00 behaal</td><td class="text-right mono">+20 indien van toepassing</td><td class="text-right mono" id="slimEarlyCell">0</td></tr>
                    <tr><td>Verbeter jou eie beste telling vir die dag</td><td class="text-right mono">+30 (maks 1/dag)</td><td class="text-right mono" id="slimImproveCell">0</td></tr>
                    <tr><td>Finale posisie om 23:55</td><td class="text-right mono">120/90/70/60/50/40/30/25/20/15</td><td class="text-right mono" id="slimPlaceCell">0</td></tr>
                    <tr class="archiveOnly hidden"><td>Argief: PB-punt</td><td class="text-right mono">+10 (eenmalig per dag)</td><td class="text-right mono" id="slimPBArchiveCell">0</td></tr>
                  </tbody>
                  <tfoot>
                    <tr><td class="font-extrabold text-slate-900">Totaal (vandag)</td><td></td><td id="totalCellSlim" class="text-right font-extrabold mono text-teal-900">0</td></tr>
                  </tfoot>
                </table>
              </div>
            </div>

            <details class="mt-4">
              <summary class="font-bold text-slate-800 cursor-pointer">Reëls vir Slimstiek (opsomming)</summary>
              <ul class="text-sm text-slate-700 mt-2 list-disc pl-5 space-y-1">
                <li>Leierbord: maks. 10; een inskrywing per speler (beste vervang ouer).</li>
                <li>Tydvensters (ZA): Vroeë bonus vanaf 07:00; Finale posisie om 23:55.</li>
                <li>Punte (vandag): Vroeë +20; Verbetering +30 (1×/dag); Finale: 120,90,70,60,50,40,30,25,20,15.</li>
                <li>Ondersteuner: ×1.10 oor vandag se som; daaglikse kap per spel: 200.</li>
                <li>Argief: Geen vroeë of posisie-punte; PB +10 (eenmalig per argief-dag).</li>
              </ul>
            </details>
          </div>

          <!-- Stats -->
          <div>
            <h3 class="text-sm font-bold text-slate-700 mb-2">Slimstiek-statistiek</h3>
            <div class="grid grid-cols-4 gap-2 mb-4">
              <div class="mini"><div id="playedStatSlim" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Gespeel</div></div>
              <div class="mini"><div id="bestScoreSlim" class="text-3xl font-extrabold mono">—</div><div class="text-xs text-slate-500 mt-1">Beste telling</div></div>
              <div class="mini"><div id="avgScoreSlim" class="text-3xl font-extrabold mono">—</div><div class="text-xs text-slate-500 mt-1">Gemiddeld</div></div>
              <div class="mini"><div id="winsSlim" class="text-3xl font-extrabold mono">0</div><div class="text-xs text-slate-500 mt-1">Oorwinnings</div></div>
            </div>

            <h4 class="text-sm font-bold text-slate-700 mb-2">Verspreiding (bv. punte-klasse)</h4>
            <div id="distWrapSlim" class="space-y-2 text-slate-400">Kom binnekort.</div>

            <div class="col-summary push-end text-sm text-slate-600">
              <span class="font-semibold">Leidraad:</span> Hierdie Slimstiek-punte is nog proeflopie en tel nie by jou Kriptiek-telling nie.
            </div>
          </div>
        </div>
      </section>
    </div> <!-- /max-w wrapper for GAMES -->
  </main>

  <!-- Footer (keep your real site footer if needed) -->
  <footer class="mt-8 border-t border-slate-200 bg-white">
    <div class="max-w-6xl mx-auto px-4 py-6 text-sm text-slate-500">
      © <span id="yearNow"></span> Kriptiek. Alle regte voorbehou.
    </div>
  </footer>

  <script>
    // Tiny helper to keep the footer year fresh
    document.getElementById('yearNow').textContent = new Date().getFullYear();

    // OPTIONAL: if you want quick empty-state messaging for “not played today”
    // Example:
    // if (!playedTodayDilemma) {
    //   document.getElementById('calcTime').textContent = '—';
    //   document.getElementById('totalPoints').textContent = '0';
    // }

    // New IDs you can set when your overall totals refresh:
    //   Dilemma: dilOverallScore, dilOverallUpdated
    //   Blitstiek: blitOverallScore, blitOverallUpdated
    //   Slimstiek: slimOverallScore, slimOverallUpdated
  </script>
  <!-- Firebase SDKs (same as live Kriptiek) -->
  <script type="module">
    // Import Firebase modules (v10+ style)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, sendPasswordResetEmail, deleteUser, updateProfile } 
      from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, query, where, getDocs } 
      from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ---- Firebase configuration ----
    const firebaseConfig = {
      apiKey: "AIzaSyCdM-4asNdcSpLGkSMosAoV8RUsH_KrfM4",
      authDomain: "kriptiek.firebaseapp.com",
      projectId: "kriptiek",
      storageBucket: "kriptiek.appspot.com",
      messagingSenderId: "598423858938",
      appId: "1:598423858938:web:2e6e021179963eb48f1cf4"
    };

    // ---- Initialize app and services ----
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    // ---- Auth listener ----
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        console.log("No user signed in");
        return;
      }

      console.log("Signed in as:", user.displayName || user.email);
      document.getElementById("nameInput").value  = user.displayName || "";
      document.getElementById("emailInput").value = user.email || "";

      // Fetch user totals (optional overall blocks)
      try {
        const userDoc = await getDoc(doc(db, "users", user.uid));
        if (userDoc.exists()) {
          const u = userDoc.data();
          if (u.kDilemma_total !== undefined) {
            document.getElementById("dilOverallScore").textContent = u.kDilemma_total;
            document.getElementById("dilOverallUpdated").textContent =
              u.updatedAt || "—";
          }
          if (u.kBlit_total !== undefined) {
            document.getElementById("blitOverallScore").textContent = u.kBlit_total;
            document.getElementById("blitOverallUpdated").textContent =
              u.updatedAt || "—";
          }
          if (u.kSlim_total !== undefined) {
            document.getElementById("slimOverallScore").textContent = u.kSlim_total;
            document.getElementById("slimOverallUpdated").textContent =
              u.updatedAt || "—";
          }
          if (u.kScore !== undefined)
            document.getElementById("pillOverall").textContent =
              `JOU KRIPTIEK-TELLING: ${u.kScore}`;
        }
      } catch (err) {
        console.error("Firestore read failed:", err);
      }
    });

    // ---- Profile form actions ----
    const form = document.getElementById("profileForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return alert("Geen gebruiker aangemeld nie.");

      const name = document.getElementById("nameInput").value.trim();
      try {
        await updateProfile(user, { displayName: name });
        await setDoc(doc(db, "users", user.uid), { userName: name }, { merge: true });
        document.getElementById("formMsg").textContent = "Naam suksesvol bygewerk.";
        document.getElementById("formMsg").classList.remove("hidden");
      } catch (err) {
        console.error(err);
        alert("Kon nie stoor nie: " + err.message);
      }
    });

    // ---- Reset password ----
    document.getElementById("resetPwBtn").addEventListener("click", async () => {
      const email = document.getElementById("emailInput").value.trim();
      if (!email) return alert("Tik jou e-pos in.");
      try {
        await sendPasswordResetEmail(auth, email);
        alert("Wagwoord-herstel-skakel gestuur aan " + email);
      } catch (err) {
        alert(err.message);
      }
    });

    // ---- Delete account ----
    document.getElementById("deleteBtn").addEventListener("click", async () => {
      const user = auth.currentUser;
      if (!user) return alert("Geen gebruiker aangemeld nie.");
      if (!confirm("Wil jy jou rekening permanent uitvee?")) return;
      try {
        await deleteUser(user);
        alert("Rekening verwyder.");
      } catch (err) {
        alert("Kon nie uitvee nie: " + err.message);
      }
    });
  </script>
</body>
</html>
