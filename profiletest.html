<!DOCTYPE html>
<html lang="af">
<head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S9V4CMP1FP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-S9V4CMP1FP');
</script>

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>My Profiel – Kriptiek (toets)</title>

<!-- Favicon and App Icons -->
<link rel="icon" href="/assets/favicon.ico?v=2" type="image/x-icon" />
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png?v=3">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png?v=3">
<link rel="apple-touch-icon" href="/assets/apple-touch-icon.png?v=3">
<link rel="manifest" href="/assets/site.webmanifest?v=3">

<!-- Social Share Image -->
<meta property="og:image" content="https://www.kriptiek.com/assets/share-logo.png?v=1" />
<meta name="twitter:image" content="https://www.kriptiek.com/assets/share-logo.png?v=1" />
<meta property="og:title" content="Kriptiek – Tuiste van DILEMMA" />
<meta property="og:description" content="Speel DILEMMA aanlyn" />
<meta property="og:url" content="https://www.kriptiek.com/" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="image" content="https://www.kriptiek.com/assets/share-logo.png?v=1" />

<!-- Styles -->
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700;800;900&display=swap" rel="stylesheet">

<style>
  body { font-family: 'Montserrat', sans-serif; }
  .card { background:#fff; border:1px solid #e5e7eb; border-radius: 0.75rem; box-shadow: 0 2px 6px rgba(2,6,23,.04); }
  .pill { display:inline-flex; align-items:center; border-radius:999px; padding:.3rem .7rem; font-weight:800; font-size:.9rem; }
  .pill-lg { padding:.45rem .9rem; font-size:.95rem; }
  .pill-blue { background:#e0e7ff; color:#1e3a8a; }
  .pill-orange { background:#fff1e6; color:#c2410c; }
  .pill-green { background:#e8fff3; color:#065f46; }
  .pill-green-dark { background:#e6fffb; color:#115e59; }
  .mono { font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1, 'lnum' 1; }
  .table-wrap { border:1px solid #e5e7eb; border-radius:.75rem; overflow:hidden; }
  .table-scroll { overflow:auto; }
  table.table { border-collapse:collapse; width:100%; }
  table.table th, table.table td { padding:.6rem .75rem; border-bottom:1px solid #eef2f7; }
  table.table thead th { font-size:.8rem; text-transform:uppercase; letter-spacing:.02em; color:#64748b; background:#fafbff; }
  .mini { background:#f8fafc; border:1px solid #e5e7eb; border-radius:.75rem; padding:.5rem .6rem; text-align:center; }
  .supporter-banner { display:block; text-align:center; font-weight:800; border-radius:.75rem; padding:.5rem .75rem; }
  .supporter-banner-red { background:#fff1f2; color:#991b1b; border:1px solid #fecdd3; }
</style>

<!-- Firebase boot (same project & versions as index.html) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, sendPasswordResetEmail, deleteUser, updateProfile } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDH-nVvGkdaheH7pvRHH0M9TbW2f98lMGQ",
    authDomain: "kriptiek-c9ea2.firebaseapp.com",
    projectId: "kriptiek-c9ea2",
    storageBucket: "kriptiek-c9ea2.appspot.com",
    messagingSenderId: "620450620939",
    appId: "1:620450620939:web:e93a18ac23b53b33db890e"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db   = getFirestore(app);

  // Expose logout (parity with index.html)
  window.kriptiekLogout = async function () {
    try { await import("https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js").then(m => m.signOut(auth)); }
    finally { try { localStorage.clear(); sessionStorage.clear(); } catch{}; setTimeout(() => location.href="/index.html", 120); }
  };

  // Helper to set supporter pill styling
  function setSupporterPill(isActive, labelExtra="") {
    const el = document.getElementById("supporterPill");
    if (!el) return;
    if (isActive) {
      el.textContent = "ONDERSTEUNER: AKTIEF" + (labelExtra ? ` — ${labelExtra}` : "");
      el.style.background = "#dcfce7"; // green-50
      el.style.color = "#065f46";      // green-900
      el.style.border = "1px solid #bbf7d0";
      el.classList.add("font-extrabold");
    } else {
      el.textContent = "ONDERSTEUNER: NIE AKTIEF NIE";
      el.style.background = "#fef2f2"; // red-50
      el.style.color = "#991b1b";      // red-900
      el.style.border = "1px solid #fecaca";
      el.classList.add("font-extrabold");
    }
  }

  // Auth listener → populate fields & overall scores + supporter pill
  onAuthStateChanged(auth, async (user) => {
    if (!user) return;
    const nameEl  = document.getElementById("nameInput");
    const emailEl = document.getElementById("emailInput");
    if (nameEl)  nameEl.value  = user.displayName || "";
    if (emailEl) emailEl.value = user.email || "";

    try {
      const snap = await getDoc(doc(db, "users", user.uid));
      if (snap.exists()) {
        const u = snap.data();

        // Overall totals + updated stamps (if you store fields with those names)
        if (u.kDilemma_total !== undefined) document.getElementById("dilOverallScore").textContent = u.kDilemma_total;
        if (u.kBlit_total     !== undefined) document.getElementById("blitOverallScore").textContent = u.kBlit_total;
        if (u.kSlim_total     !== undefined) document.getElementById("slimOverallScore").textContent = u.kSlim_total;

        if (u.kScore !== undefined) document.getElementById("pillOverall").textContent = `JOU KRIPTIEK-TELLING: ${u.kScore}`;

        if (u.updatedAt) {
          const stamp = u.updatedAt; // string or ms
          const s = typeof stamp === "number" ? new Date(stamp) : new Date(Date.parse(stamp));
          const nice = isNaN(s) ? "—" : s.toLocaleString("af-ZA");
          ["dilOverallUpdated","blitOverallUpdated","slimOverallUpdated"].forEach(id => {
            const el = document.getElementById(id); if (el) el.textContent = nice;
          });
        }

        // Supporter: isPaid or paidUntil
        let active = !!u.isPaid;
        let labelExtra = "";
        if (u.paidUntil) {
          const until = typeof u.paidUntil === "number" ? u.paidUntil : Date.parse(u.paidUntil);
          if (!Number.isNaN(until) && until > Date.now()) {
            active = true;
            labelExtra = `tot ${new Date(until).toLocaleDateString("af-ZA")}`;
          }
        }
        setSupporterPill(active, labelExtra);
      }
    } catch (e) { console.error(e); }
  });

  // Profile form handlers
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById("profileForm");
    const resetBtn = document.getElementById("resetPwBtn");
    const delBtn   = document.getElementById("deleteBtn");

    if (form) form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const user = auth.currentUser; if (!user) return alert("Geen gebruiker aangemeld nie.");
      const name = document.getElementById("nameInput").value.trim();
      try {
        await updateProfile(user, { displayName: name });
        await setDoc(doc(db, "users", user.uid), { userName: name }, { merge: true });
        const msg = document.getElementById("formMsg");
        if (msg) { msg.textContent = "Naam suksesvol bygewerk."; msg.classList.remove("hidden"); }
      } catch (err) { alert("Kon nie stoor nie: " + err.message); }
    });

    if (resetBtn) resetBtn.addEventListener("click", async () => {
      const email = (document.getElementById("emailInput")?.value || "").trim();
      if (!email) return alert("Tik jou e-pos in.");
      try { await sendPasswordResetEmail(auth, email); alert("Wagwoord-herstel-skakel gestuur aan " + email); }
      catch (err) { alert(err.message); }
    });

    if (delBtn) delBtn.addEventListener("click", async () => {
      const user = auth.currentUser; if (!user) return alert("Geen gebruiker aangemeld nie.");
      if (!confirm("Wil jy jou rekening permanent uitvee?")) return;
      try { await deleteUser(user); alert("Rekening verwyder."); }
      catch (err) { alert("Kon nie uitvee nie: " + err.message); }
    });
  });
</script>

</head>

<body class="bg-gray-100 min-h-screen flex flex-col">
  <!-- EXACT header from index.html -->
  <header class="bg-white shadow p-4">
    <div class="logo-container">
      <div id="backgroundCrossword" class="background-crossword"></div>
      <div class="crossword-grid">
        <div class="letter-box flipped-k">K</div>
        <div class="letter-box flipped-k">R</div>
        <div class="letter-box">I</div>
        <div class="letter-box flipped-k">P</div>
        <div class="letter-box">T</div>
        <div class="letter-box">I</div>
        <div class="letter-box flipped-k">E</div>
        <div class="letter-box">K</div>
      </div>
    </div>
  </header>

  <main class="flex-grow p-4 pb-16">
    <!-- Top: Profile + overview (mobile-first stack) -->
    <div class="max-w-6xl mx-auto flex flex-col gap-6 items-stretch">

      <!-- Profile -->
      <section class="card p-5 md:p-6">
        <a id="supporterBanner" href="https://buymeacoffee.com/kriptiek" target="_blank" rel="noopener"
           class="supporter-banner supporter-banner-red mb-4"
           aria-label="Word ’n ondersteuner (Buy Me a Coffee)">
          <span id="supporterBannerTxt">Kliek hier om 'n betalende ondersteuner te word</span>
        </a>

        <h2 class="text-lg font-bold mb-2">Profiel</h2>
        <p id="errBanner" class="hidden text-sm mb-3 px-3 py-2 rounded bg-red-50 text-red-800" role="alert"></p>

        <form id="profileForm" class="space-y-4" novalidate>
          <div>
            <label for="nameInput" class="block text-sm font-semibold text-gray-700">Naam (kan ’n skuilnaam wees)</label>
            <input id="nameInput" type="text" minlength="2" maxlength="40" required class="mt-1 w-full border border-gray-300 rounded p-2" value="Speler"/>
          </div>
          <div>
            <label for="emailInput" class="block text-sm font-semibold text-gray-700">E-posadres</label>
            <input id="emailInput" type="email" required aria-describedby="emailHelp" class="mt-1 w-full border border-gray-300 rounded p-2" value="speler@example.com"/>
            <p id="emailHelp" class="text-xs text-gray-500 mt-1"><strong>Let wel:</strong> Jou e-pos word nie geverifieer nie, maar jy het dit nodig vir wagwoordherstel of navrae oor jou rekening.</p>
          </div>

          <div class="flex flex-wrap items-center gap-2">
            <button type="submit" class="px-4 py-2 rounded-xl bg-blue-900 text-white font-bold" id="saveBtn">BÊRE</button>
            <button id="resetPwBtn" type="button" class="px-4 py-2 rounded-xl bg-slate-800 text-white font-bold">VRA NUWE WAGWOORD</button>
            <button id="deleteBtn" type="button" class="px-4 py-2 rounded-xl bg-red-700 text-white font-bold">VERWYDER MY REKENING</button>
          </div>
          <p id="formMsg" class="text-sm mt-2 hidden" aria-live="polite" role="status"></p>
          <p id="deleteMsg" class="text-sm mt-2 hidden" aria-live="polite" role="status"></p>
        </form>
      </section>

      <!-- Overview + Ondersteuner pill -->
      <section class="card p-5 md:p-6">
        <div class="mb-2">
          <span id="supporterPill" class="pill pill-lg" role="status"
                style="background:#f1f5f9;color:#0f172a;border:1px solid #e2e8f0">
            ONDERSTEUNER: ONBESKOSTIG
          </span>
        </div>
        <div class="mb-4">
          <span id="pillOverall" class="pill pill-lg pill-blue" role="status">JOU KRIPTIEK-TELLING: 0</span>
        </div>
        <div class="flex flex-wrap gap-2 mb-4 items-start">
          <span id="pillDilemmaLive" class="pill pill-lg pill-orange" role="status">JOU DILEMMA-TELLING: 0</span>
          <span id="pillBlitLive" class="pill pill-lg pill-green" role="status">JOU BLITSTIEK-TELLING: 0</span>
          <span class="pill pill-lg pill-green-dark">JOU SLIMSTIEK-TELLING: BINNEKORT</span>
        </div>
        <p class="text-sm text-slate-600">
          Jou Kriptiek-telling is die som van jou <strong>Dilemma</strong>- en <strong>Blitstiek</strong>-tellings (Slimstiek volg later).
        </p>
      </section>
    </div>

    <!-- GAMES -->
    <div class="max-w-6xl mx-auto space-y-6 mt-6">
      <!-- DILEMMA -->
      <section class="card p-5 md:p-6">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-orange-500 rounded-full"></div>
          <h2 class="text-xl font-extrabold text-slate-900">DILEMMA</h2>
        </header>

        <!-- OVERALL (big & bold) -->
        <div class="rounded-xl border border-slate-200 bg-white p-4 mb-3">
          <div class="flex items-end gap-4">
            <div>
              <div id="dilOverallScore" class="text-6xl font-black mono text-slate-900 tracking-tight">0</div>
              <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Laas opgedateer</div>
              <div id="dilOverallUpdated" class="text-sm mono">—</div>
            </div>
          </div>
        </div>

        <!-- TODAY -->
        <div class="rounded-xl border border-orange-200 bg-orange-50 p-4 mb-4">
          <div class="flex items-end gap-4">
            <div>
              <div id="totalPoints" class="text-4xl md:text-5xl font-extrabold mono text-orange-900">0</div>
              <div class="text-xs uppercase tracking-wide text-orange-900/70">Vandag</div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-orange-900/70">Laas bereken</div>
              <div id="calcTime" class="text-sm mono">—</div>
            </div>
          </div>
          <div class="text-[13px] text-orange-900/80 mt-2">
            Lopie- en ondersteuners-bonusse word hier ingereken soos van toepassing.
          </div>
        </div>

        <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
        <div class="table-wrap">
          <div class="table-scroll">
            <table class="table text-sm">
              <thead>
                <tr>
                  <th class="text-left">Komponent</th>
                  <th class="text-right">Aantal</th>
                  <th class="text-right mono">Formule</th>
                  <th class="text-right">Punte</th>
                </tr>
              </thead>
              <tbody id="breakdownBody"></tbody>
              <tfoot>
                <tr><td class="font-bold">Subtotaal</td><td></td><td></td><td class="text-right font-extrabold mono" id="subtotalCell">0</td></tr>
                <tr><td class="font-bold">Lopie-bonus</td><td></td><td class="text-right whitespace-nowrap" id="lopieMeta">—</td><td class="text-right font-extrabold mono" id="lopieBonusCell">0</td></tr>
                <tr><td class="font-bold">Ondersteuner-bonus</td><td></td><td class="text-right whitespace-nowrap" id="supporterMeta">—</td><td class="text-right font-extrabold mono" id="supporterBonusCell">0</td></tr>
                <tr><td class="font-extrabold text-slate-900">Totaal (vandag)</td><td></td><td></td><td class="text-right font-extrabold mono text-orange-900" id="totalCell">0</td></tr>
              </tfoot>
            </table>
          </div>
        </div>
      </section>

      <!-- BLITSTIEK -->
      <section class="card p-5 md:p-6">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-emerald-500 rounded-full"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold text-slate-900">BLITSTIEK</h2>
            <div id="bannerBlit" class="text-xs font-extrabold px-2 py-1 rounded bg-emerald-50 border border-emerald-200 text-emerald-900">
              Vandag (voorlopig, finale posisie om 23:55)
            </div>
          </div>
        </header>

        <!-- OVERALL (big & bold) -->
        <div class="rounded-xl border border-slate-200 bg-white p-4 mb-3">
          <div class="flex items-end gap-4">
            <div>
              <div id="blitOverallScore" class="text-6xl font-black mono text-slate-900 tracking-tight">0</div>
              <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Laas opgedateer</div>
              <div id="blitOverallUpdated" class="text-sm mono">—</div>
            </div>
          </div>
          <div class="text-[13px] text-slate-600 mt-2">
            Totale Blitstiek-telling (alle dae).
          </div>
        </div>

        <!-- TODAY -->
        <div class="rounded-xl border border-emerald-200 bg-emerald-50 p-4 mb-4">
          <div class="flex items-end gap-4">
            <div>
              <div id="totalPointsBlit" class="text-4xl md:text-5xl font-extrabold mono text-emerald-900">0</div>
              <div class="text-xs uppercase tracking-wide text-emerald-900/70">
                Vandag (na 23:55 sluit ×1.10 in indien ondersteuner)
              </div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-emerald-900/70">Laas bereken</div>
              <div id="calcTimeBlit" class="text-sm mono">—</div>
            </div>
          </div>
        </div>

        <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
        <div class="table-wrap">
          <div class="table-scroll">
            <table class="table text-sm">
              <thead>
                <tr><th class="text-left">Komponent</th><th class="text-right">Reël</th><th class="text-right">Punte</th></tr>
              </thead>
              <tbody id="breakdownBodyBlit">
                <tr>
                  <td>Tyd-bonus (vandag)</td>
                  <td class="text-right mono">&lt;60s = +100 • &lt;30s = +200 (een van die twee)</td>
                  <td class="text-right mono" id="blitInstantCell">0</td>
                </tr>
                <tr class="liveOnly">
                  <td>Posisie-bonus (om 23:55)</td>
                  <td class="text-right mono">1–10: 200,175,150,125,100,75,50,40,30,20</td>
                  <td class="text-right mono" id="blitPlaceCell">0</td>
                </tr>
              </tbody>
              <tfoot>
                <tr class="liveOnly">
                  <td class="font-extrabold text-slate-900">Totaal (vandag)</td>
                  <td class="text-right text-slate-500">ná ondersteuners-×1.10 indien aktief</td>
                  <td id="totalCellBlit" class="text-right font-extrabold mono text-emerald-900">0</td>
                </tr>
                <tr class="archiveOnly hidden">
                  <td class="font-extrabold text-slate-900">Totaal (argief)</td>
                  <td class="text-right text-slate-500">geen posisie/ondersteuner-bonus</td>
                  <td id="totalCellBlitArchive" class="text-right font-extrabold mono text-emerald-900">0</td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </section>

      <!-- SLIMSTIEK -->
      <section class="card p-5 md:p-6">
        <header class="flex flex-col gap-1 mb-3">
          <div class="h-1 w-full bg-teal-500 rounded-full"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold text-slate-900">SLIMSTIEK</h2>
            <div id="bannerSlim" class="text-xs font-extrabold px-2 py-1 rounded bg-teal-50 border border-teal-200 text-teal-900">
              Vandag (voorlopig, finale posisie om 23:55)
            </div>
          </div>
        </header>

        <!-- OVERALL (big & bold) -->
        <div class="rounded-xl border border-slate-200 bg-white p-4 mb-3">
          <div class="flex items-end gap-4">
            <div>
              <div id="slimOverallScore" class="text-6xl font-black mono text-slate-900 tracking-tight">0</div>
              <div class="text-xs uppercase tracking-wide text-slate-500">Algeheel (totaal)</div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Laas opgedateer</div>
              <div id="slimOverallUpdated" class="text-sm mono">—</div>
            </div>
          </div>
          <div class="text-[13px] text-slate-600 mt-2">
            Totale Slimstiek-telling (binnekort aktief).
          </div>
        </div>

        <!-- TODAY -->
        <div class="rounded-xl border border-teal-200 bg-teal-50 p-4 mb-4">
          <div class="flex items-end gap-4">
            <div>
              <div id="totalPointsSlim" class="text-4xl md:text-5xl font-extrabold mono text-teal-900">0</div>
              <div class="text-xs uppercase tracking-wide text-teal-900/70">Vandag se voorlopige punte</div>
            </div>
            <div class="ml-auto text-right">
              <div class="text-xs text-teal-900/70">Laas bereken</div>
              <div id="calcTimeSlim" class="text-sm mono">—</div>
            </div>
          </div>
        </div>

        <h3 class="text-sm font-bold text-slate-700 mb-2">Vandag se ontleding</h3>
        <div class="table-wrap">
          <div class="table-scroll">
            <table class="table text-sm">
              <thead>
                <tr><th class="text-left">Komponent</th><th class="text-right">Reël</th><th class="text-right">Punte</th></tr>
              </thead>
              <tbody id="breakdownBodySlim">
                <tr><td>Vroeë bonus vir eerste 10 tellings ná 07:00</td><td class="text-right mono">+20 indien van toepassing</td><td class="text-right mono" id="slimEarlyCell">0</td></tr>
                <tr><td>Verbeter jou eie beste telling vir die dag</td><td class="text-right mono">+30 (maks 1/dag)</td><td class="text-right mono" id="slimImproveCell">0</td></tr>
                <tr><td>Finale posisie om 23:55</td><td class="text-right mono">120/90/70/60/50/40/30/25/20/15</td><td class="text-right mono" id="slimPlaceCell">0</td></tr>
                <tr class="archiveOnly hidden"><td>Argief: PB-punt</td><td class="text-right mono">+10 (eenmalig per dag)</td><td class="text-right mono" id="slimPBArchiveCell">0</td></tr>
              </tbody>
              <tfoot>
                <tr><td class="font-extrabold text-slate-900">Totaal (vandag)</td><td></td><td id="totalCellSlim" class="text-right font-extrabold mono text-teal-900">0</td></tr>
              </tfoot>
            </table>
          </div>
        </div>
      </section>
    </div> <!-- /games -->
  </main>

  <!-- EXACT footer from index.html -->
  <footer class="bg-white shadow p-4 text-center text-sm text-gray-500">
    &copy; 2025 Kriptiek. Alle regte voorbehou. |
    <a href="/profile.html" class="underline">My profiel</a> |
    <a href="/forum.html" class="underline">Gesels saam</a> |
    <a href="/privacy.html" class="underline">Privaatheidsbeleid</a> |
    <a href="/terms.html" class="underline">Voorwaardes</a> |
    <a href="/faq.html" class="underline">Gereelde vrae</a> |
    <a href="/about.html" class="underline">Oor Kriptiek</a> |
    <a href="/contact.html" class="underline">Kontak ons</a>
  </footer>

  <!-- Background crossword (same behaviour as index header) -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const backgroundCrossword = document.getElementById('backgroundCrossword');
      if (!backgroundCrossword) return;
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      function rand(){ return letters[Math.floor(Math.random()*letters.length)]; }
      function regen(){
        backgroundCrossword.innerHTML = '';
        const numRows = Math.ceil(backgroundCrossword.offsetHeight / 30);
        const numCols = Math.ceil(backgroundCrossword.offsetWidth / 30);
        const total = (numRows * numCols) || 300;
        for (let i = 0; i < total; i++) {
          const d = document.createElement('div');
          d.className = 'bg-letter-box';
          d.textContent = rand();
          backgroundCrossword.appendChild(d);
        }
      }
      regen(); window.addEventListener('resize', regen);
    });
  </script>
</body>
</html>
